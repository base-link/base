
load @drumwork/dock/code/javascript/binding/number
  take task add
  take task subtract
  take task decrement
load @drumwork/dock/code/javascript/binding/base
  take task check-if-strictly-equal
  take task check-gt
  take task check-else
  take task walk
load @drumwork/dock/code/javascript/binding/console
  take task log

task assert-equal
  base base
  base head

  call check-if-strictly-equal
    bind left, link base
    bind right, link head

task find-fibonacci-via-loop
  base i

  host g, size 0
  host o, size 1
  host d

  call walk
    hook test
      call check-gt
        bind left, link i
        bind right, text 0
        turn seed
    hook link
      save d, link o
      call add
        bind base, link g
        bind head, link d
        save o
      save g, link d
      call decrement
        bind integer, link i
        save i

  turn seed, link g

task find-fibonacci-via-recursion
  base i
  base g, base 0
  base o, base 1

  call check-else
    bind blob, link i
    hook like
      turn seed, link g
    hook miss
      call subtract
        bind base, link i
        bind head, text 1
        save d
      call add
        bind base, link o
        bind head, link g
        save t
      call find-fibonacci-via-recursion
        bind i, link d
        bind g, link o
        bind o, link t
        turn seed
    turn seed

task test-fibonacci-loop
  call find-fibonacci-via-loop
    bind i, text 7
    save o
  call log
    bind message, link o
  call assert-equal
    bind base, text 13
    bind head, link o
